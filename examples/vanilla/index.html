<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DevInspector - Vanilla JavaScript Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f39c12 0%, #e74c3c 50%, #9b59b6 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }
        
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(255,255,255,0.2);
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shimmer 3s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        
        .header h1 {
            font-size: 3.5rem;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            background: linear-gradient(45deg, #f39c12, #e74c3c, #9b59b6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            z-index: 1;
        }
        
        .js-logo {
            font-size: 4rem;
            margin: 20px 0;
            animation: bounce 2s ease-in-out infinite;
            position: relative;
            z-index: 1;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-20px); }
            60% { transform: translateY(-10px); }
        }
        
        .component-section {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
        }
        
        .component-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }
        
        .component-section h2 {
            margin-top: 0;
            color: #ffd700;
            border-bottom: 2px solid #f39c12;
            padding-bottom: 10px;
        }
        
        .controls-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            min-width: 250px;
            z-index: 1000;
            border: 2px solid #f39c12;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .controls-panel h3 {
            margin: 0 0 15px 0;
            color: #f39c12;
            text-align: center;
        }
        
        .layout-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .layout-btn {
            padding: 10px;
            background: #2c3e50;
            color: #f39c12;
            border: 1px solid #f39c12;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .layout-btn:hover {
            background: #f39c12;
            color: #2c3e50;
            transform: scale(1.05);
        }
        
        .layout-btn.active {
            background: #f39c12;
            color: #2c3e50;
            font-weight: bold;
        }
        
        .feature-card {
            background: rgba(44, 62, 80, 0.8);
            border: 2px solid rgba(243, 156, 18, 0.6);
            border-radius: 12px;
            padding: 25px;
            margin: 15px 0;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(243, 156, 18, 0.1), transparent);
            transition: left 0.5s;
        }
        
        .feature-card:hover::before {
            left: 100%;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(243, 156, 18, 0.3);
            border-color: #f39c12;
        }
        
        .feature-card h3 {
            color: #f39c12;
            margin: 0 0 15px 0;
            position: relative;
            z-index: 1;
        }
        
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin: 15px 0;
        }
        
        .btn {
            padding: 12px 20px;
            border: 2px solid;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            background: transparent;
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: currentColor;
            transition: left 0.3s;
            z-index: -1;
        }
        
        .btn:hover::before {
            left: 0;
        }
        
        .btn:hover {
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .btn-primary {
            border-color: #4CAF50;
            color: #4CAF50;
        }
        
        .btn-secondary {
            border-color: #2196F3;
            color: #2196F3;
        }
        
        .btn-warning {
            border-color: #FF9800;
            color: #FF9800;
        }
        
        .btn-danger {
            border-color: #F44336;
            color: #F44336;
        }
        
        .btn-info {
            border-color: #9C27B0;
            color: #9C27B0;
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            border: 2px solid #f39c12;
            border-radius: 8px;
            background: rgba(44, 62, 80, 0.8);
            color: white;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            outline: none;
            box-shadow: 0 0 15px rgba(243, 156, 18, 0.5);
            border-color: #ffd700;
            transform: scale(1.02);
        }
        
        .state-display {
            background: rgba(0,0,0,0.5);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            border-left: 4px solid #f39c12;
            position: relative;
            z-index: 1;
        }
        
        .counter-display {
            font-size: 3rem;
            text-align: center;
            margin: 20px 0;
            color: #ffd700;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .metric-card {
            background: rgba(44, 62, 80, 0.8);
            border: 1px solid #f39c12;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .metric-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(243, 156, 18, 0.1) 0%, transparent 70%);
            animation: pulse 3s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.2); opacity: 1; }
        }
        
        .metric-card:hover {
            transform: scale(1.05);
            border-color: #ffd700;
        }
        
        .metric-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #4CAF50;
            position: relative;
            z-index: 1;
        }
        
        .metric-label {
            font-size: 0.9rem;
            color: #f39c12;
            margin-top: 5px;
            position: relative;
            z-index: 1;
        }
        
        .canvas-container {
            position: relative;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        #demo-canvas {
            width: 100%;
            height: 300px;
            display: block;
        }
        
        .notification {
            position: fixed;
            top: 100px;
            right: 20px;
            background: rgba(243, 156, 18, 0.9);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1001;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #f39c12, #e74c3c, #9b59b6);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Controls Panel -->
        <div class="controls-panel">
            <h3>🎛️ DevInspector Controls</h3>
            <div class="layout-grid">
                <button class="layout-btn active" onclick="setLayout('bottom-right')">📍 Bottom Right</button>
                <button class="layout-btn" onclick="setLayout('bottom-sidebar')">📊 Bottom Sidebar</button>
                <button class="layout-btn" onclick="setLayout('fullwidth')">📏 Full Width</button>
                <button class="layout-btn" onclick="setLayout('top-left')">↖️ Top Left</button>
                <button class="layout-btn" onclick="setLayout('top-right')">↗️ Top Right</button>
                <button class="layout-btn" onclick="setLayout('bottom-left')">↙️ Bottom Left</button>
            </div>
            <div style="margin-top: 15px; padding: 10px; background: rgba(243, 156, 18, 0.1); border-radius: 8px; font-size: 12px; text-align: center;">
                <strong>Keyboard Shortcuts:</strong><br/>
                Ctrl+Shift+D - Toggle<br/>
                Ctrl+Shift+M - Minimize
            </div>
        </div>
        
        <!-- Header -->
        <div class="header">
            <div class="js-logo">🟨</div>
            <h1>DevInspector + Vanilla JS</h1>
            <p>Pure JavaScript debugging power - No frameworks, just raw performance</p>
            <p>Featuring ES6+, Web APIs, and modern JavaScript patterns</p>
        </div>

        <!-- Core JavaScript Features -->
        <div class="component-section">
            <h2>🎯 Core JavaScript Features</h2>
            <p>Test fundamental JavaScript concepts and modern API usage:</p>
            
            <div class="feature-card">
                <h3>🔢 Advanced Counter with History</h3>
                <div class="counter-display" id="counter-value">0</div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; color: #f39c12; font-weight: 600;">Operation Mode:</label>
                    <select id="counter-mode" class="form-control" style="width: 200px;">
                        <option value="add">Addition</option>
                        <option value="multiply">Multiplication</option>
                        <option value="power">Power</option>
                        <option value="fibonacci">Fibonacci</option>
                    </select>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; color: #f39c12; font-weight: 600;">Step/Operand:</label>
                    <input id="counter-step" type="number" value="1" class="form-control" style="width: 100px;">
                </div>
                
                <div class="button-group">
                    <button class="btn btn-primary" onclick="performOperation('increment')">➕ Increment</button>
                    <button class="btn btn-secondary" onclick="performOperation('decrement')">➖ Decrement</button>
                    <button class="btn btn-warning" onclick="performOperation('reset')">🔄 Reset</button>
                    <button class="btn btn-info" onclick="performOperation('random')">🎲 Random</button>
                </div>

                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value" id="operation-count">0</div>
                        <div class="metric-label">Operations</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="max-value">0</div>
                        <div class="metric-label">Max Value</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="min-value">0</div>
                        <div class="metric-label">Min Value</div>
                    </div>
                </div>

                <div id="counter-history" class="state-display" style="max-height: 150px; overflow-y: auto;"></div>
            </div>
        </div>

        <!-- Modern JavaScript APIs -->
        <div class="component-section">
            <h2>🌐 Modern JavaScript APIs</h2>
            <p>Explore modern browser APIs and asynchronous JavaScript:</p>
            
            <div class="feature-card">
                <h3>🌐 Advanced Fetch & API Testing</h3>
                
                <div class="button-group">
                    <button class="btn btn-primary" onclick="parallelFetch()">🔄 Parallel Requests</button>
                    <button class="btn btn-secondary" onclick="sequentialFetch()">⏭️ Sequential Requests</button>
                    <button class="btn btn-info" onclick="raceCondition()">🏃‍♂️ Race Condition</button>
                    <button class="btn btn-warning" onclick="retryWithBackoff()">🔁 Retry Logic</button>
                    <button class="btn btn-danger" onclick="simulateTimeouts()">⏱️ Timeout Test</button>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" id="api-progress"></div>
                </div>

                <div id="api-results" class="state-display" style="max-height: 200px; overflow-y: auto;"></div>
            </div>

            <div class="feature-card">
                <h3>🎮 Interactive Canvas Demo</h3>
                
                <div class="button-group">
                    <button class="btn btn-primary" onclick="startParticleSystem()">✨ Particle System</button>
                    <button class="btn btn-secondary" onclick="drawFractal()">🌀 Fractal Pattern</button>
                    <button class="btn btn-info" onclick="animatedGraph()">📊 Animated Graph</button>
                    <button class="btn btn-warning" onclick="clearCanvas()">🧹 Clear Canvas</button>
                </div>

                <div class="canvas-container">
                    <canvas id="demo-canvas" width="800" height="300"></canvas>
                </div>

                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value" id="fps-display">60</div>
                        <div class="metric-label">FPS</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="particles-count">0</div>
                        <div class="metric-label">Particles</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="render-time">0</div>
                        <div class="metric-label">Render (ms)</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance & Memory -->
        <div class="component-section">
            <h2>⚡ Performance & Memory Management</h2>
            <p>Test JavaScript performance and memory optimization techniques:</p>
            
            <div class="feature-card">
                <h3>🧠 Memory & Performance Testing</h3>
                
                <div class="button-group">
                    <button class="btn btn-primary" onclick="memoryStressTest()">🧠 Memory Stress</button>
                    <button class="btn btn-secondary" onclick="cpuIntensiveTask()">⚙️ CPU Intensive</button>
                    <button class="btn btn-info" onclick="memoryLeakTest()">🕳️ Memory Leak</button>
                    <button class="btn btn-warning" onclick="garbageCollectTest()">🗑️ GC Test</button>
                    <button class="btn btn-danger" onclick="infiniteLoopTest()">♾️ Infinite Loop</button>
                </div>

                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value" id="heap-size">0</div>
                        <div class="metric-label">Heap (MB)</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="performance-score">0</div>
                        <div class="metric-label">Performance</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="execution-time">0</div>
                        <div class="metric-label">Exec Time (ms)</div>
                    </div>
                </div>

                <div id="performance-log" class="state-display" style="max-height: 150px; overflow-y: auto;"></div>
            </div>

            <div class="feature-card">
                <h3>🐛 Error Handling & Debugging</h3>
                
                <div class="button-group">
                    <button class="btn btn-danger" onclick="throwSyntaxError()">💥 Syntax Error</button>
                    <button class="btn btn-warning" onclick="throwTypeError()">🔤 Type Error</button>
                    <button class="btn btn-info" onclick="throwReferenceError()">🔗 Reference Error</button>
                    <button class="btn btn-secondary" onclick="promiseRejectionError()">🚫 Promise Rejection</button>
                    <button class="btn btn-primary" onclick="customErrorTest()">🎯 Custom Error</button>
                </div>

                <div class="button-group">
                    <button class="btn btn-info" onclick="logComplexObjects()">📦 Complex Logging</button>
                    <button class="btn btn-secondary" onclick="performanceMarks()">⏱️ Performance Marks</button>
                    <button class="btn btn-warning" onclick="stackTraceDemo()">📚 Stack Trace</button>
                </div>

                <div id="error-log" class="state-display" style="max-height: 150px; overflow-y: auto;"></div>
            </div>
        </div>

        <!-- JavaScript Features -->
        <div class="component-section">
            <h2>🔧 Vanilla JavaScript DevInspector Integration</h2>
            <p>DevInspector automatically tracks:</p>
            <ul style="text-align: left; max-width: 600px; margin: 0 auto;">
                <li>🔧 <strong>ES6+ Features:</strong> Promises, async/await, destructuring, classes</li>
                <li>🌐 <strong>Web APIs:</strong> Fetch, Canvas, Local Storage, Web Workers</li>
                <li>⚡ <strong>Performance:</strong> Execution times, memory usage, FPS monitoring</li>
                <li>🐛 <strong>Errors:</strong> All JavaScript errors and custom error handling</li>
                <li>📱 <strong>Events:</strong> DOM events, custom events, event delegation</li>
                <li>🔄 <strong>Async Operations:</strong> Promises, callbacks, timers</li>
                <li>💾 <strong>Memory:</strong> Object creation, garbage collection, memory leaks</li>
            </ul>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notification" class="notification"></div>

    <!-- DevInspector -->
    <script src="../../dist/devinspector.umd.min.js"></script>

    <script>
        // Application State
        class VanillaJSApp {
            constructor() {
                this.inspector = null;
                this.currentLayout = 'bottom-right';
                this.counter = {
                    value: 0,
                    history: [],
                    operationCount: 0,
                    maxValue: 0,
                    minValue: 0
                };
                this.particles = [];
                this.animationId = null;
                
                this.initializeInspector();
                this.setupEventListeners();
                this.initializeUI();
                this.startPerformanceMonitoring();
                
                console.log('🟨 Vanilla JavaScript DevInspector Demo initialized!');
            }

            initializeInspector(position = 'bottom-right') {
                if (this.inspector) {
                    this.inspector.destroy();
                }

                console.log('🟨 Initializing DevInspector with Vanilla JavaScript...');
                
                this.inspector = new DevInspector({
                    enabled: true,
                    position: position,
                    theme: 'auto',
                    hotkeys: {
                        toggle: 'ctrl+shift+d',
                        minimize: 'ctrl+shift+m'
                    },
                    features: {
                        network: true,
                        console: true,
                        performance: true,
                        errors: true,
                        state: true,
                        dom: true,
                        storage: true
                    },
                    maxNetworkEntries: 200,
                    maxConsoleEntries: 500,
                    captureStackTraces: true,
                    onError: (error) => {
                        console.error('DevInspector Error:', error);
                    },
                    onPerformanceIssue: (issue) => {
                        console.warn('Performance Issue:', issue);
                    }
                });

                this.inspector.show();
                console.log(`🎯 DevInspector initialized with ${position} layout`);
            }

            setLayout(layout) {
                this.currentLayout = layout;
                this.initializeInspector(layout);
            }

            setupEventListeners() {
                // Canvas click interactions
                const canvas = document.getElementById('demo-canvas');
                canvas.addEventListener('click', (e) => {
                    const rect = canvas.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    this.addParticleAt(x, y);
                    console.log(`🎮 Canvas clicked at (${x}, ${y})`);
                });

                // Global error handling
                window.addEventListener('error', (e) => {
                    this.logError(`Global Error: ${e.error.message}`, e.error.stack);
                });

                window.addEventListener('unhandledrejection', (e) => {
                    this.logError(`Unhandled Promise Rejection: ${e.reason}`, e.reason.stack);
                });

                console.log('🎯 Event listeners setup complete');
            }

            initializeUI() {
                this.updateCounterDisplay();
                console.log('🎨 UI initialized');
            }

            startPerformanceMonitoring() {
                let frameCount = 0;
                let lastTime = performance.now();

                const monitor = () => {
                    frameCount++;
                    const currentTime = performance.now();
                    
                    if (currentTime >= lastTime + 1000) {
                        document.getElementById('fps-display').textContent = frameCount;
                        frameCount = 0;
                        lastTime = currentTime;

                        // Update memory if available
                        if (performance.memory) {
                            const heapMB = (performance.memory.usedJSHeapSize / 1024 / 1024).toFixed(1);
                            document.getElementById('heap-size').textContent = heapMB;
                        }
                    }
                    
                    requestAnimationFrame(monitor);
                };

                requestAnimationFrame(monitor);
                console.log('📊 Performance monitoring started');
            }

            // Counter Methods
            performOperation(operation) {
                const mode = document.getElementById('counter-mode').value;
                const step = parseInt(document.getElementById('counter-step').value) || 1;
                const oldValue = this.counter.value;
                
                performance.mark('operation-start');

                switch (operation) {
                    case 'increment':
                        this.counter.value = this.calculateValue(this.counter.value, step, mode, true);
                        break;
                    case 'decrement':
                        this.counter.value = this.calculateValue(this.counter.value, step, mode, false);
                        break;
                    case 'reset':
                        this.counter.value = 0;
                        break;
                    case 'random':
                        this.counter.value = Math.floor(Math.random() * 1000);
                        break;
                }

                performance.mark('operation-end');
                performance.measure('operation-duration', 'operation-start', 'operation-end');
                
                this.counter.operationCount++;
                this.counter.maxValue = Math.max(this.counter.maxValue, this.counter.value);
                this.counter.minValue = Math.min(this.counter.minValue, this.counter.value);

                this.logCounterChange(operation, oldValue, this.counter.value, mode, step);
                this.updateCounterDisplay();
                this.showNotification(`${operation.toUpperCase()}: ${oldValue} → ${this.counter.value}`);
            }

            calculateValue(current, step, mode, isIncrement) {
                const multiplier = isIncrement ? 1 : -1;
                
                switch (mode) {
                    case 'add':
                        return current + (step * multiplier);
                    case 'multiply':
                        return isIncrement ? current * step : Math.floor(current / step);
                    case 'power':
                        return isIncrement ? Math.pow(current, step) : Math.pow(current, 1/step);
                    case 'fibonacci':
                        return isIncrement ? this.fibonacci(current + step) : Math.max(0, this.fibonacci(current - step));
                    default:
                        return current + (step * multiplier);
                }
            }

            fibonacci(n) {
                if (n <= 1) return n;
                let a = 0, b = 1;
                for (let i = 2; i <= n; i++) {
                    [a, b] = [b, a + b];
                }
                return b;
            }

            logCounterChange(operation, from, to, mode, step) {
                const change = {
                    operation,
                    from,
                    to,
                    mode,
                    step,
                    timestamp: new Date().toISOString()
                };

                this.counter.history.push(change);
                console.log(`🔢 Vanilla JS Counter: ${operation} (${mode}) - ${from} → ${to}`);

                // Keep only last 20 changes
                if (this.counter.history.length > 20) {
                    this.counter.history = this.counter.history.slice(-20);
                }

                this.updateCounterHistory();
            }

            updateCounterDisplay() {
                document.getElementById('counter-value').textContent = this.counter.value;
                document.getElementById('operation-count').textContent = this.counter.operationCount;
                document.getElementById('max-value').textContent = this.counter.maxValue;
                document.getElementById('min-value').textContent = this.counter.minValue;
            }

            updateCounterHistory() {
                const historyDiv = document.getElementById('counter-history');
                historyDiv.innerHTML = this.counter.history.slice(-10).reverse().map(change => 
                    `<div style="margin: 3px 0; padding: 5px; background: rgba(243, 156, 18, 0.1); border-radius: 4px;">
                        <strong>${change.operation}</strong> (${change.mode}): ${change.from} → ${change.to}
                        <small style="float: right;">${new Date(change.timestamp).toLocaleTimeString()}</small>
                    </div>`
                ).join('');
            }

            // Utility Methods
            showNotification(message) {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }

            logError(message, stack = '') {
                const errorDiv = document.getElementById('error-log');
                const timestamp = new Date().toLocaleTimeString();
                
                const errorHtml = `
                    <div style="margin: 5px 0; padding: 8px; background: rgba(244, 67, 54, 0.1); border-radius: 4px; border-left: 3px solid #f44336;">
                        <strong>${message}</strong><br>
                        <small>Time: ${timestamp}</small>
                        ${stack ? `<br><small>Stack: ${stack.split('\\n')[0]}</small>` : ''}
                    </div>
                `;
                
                errorDiv.innerHTML = errorHtml + errorDiv.innerHTML;
                errorDiv.style.display = 'block';
                
                // Keep only last 10 errors
                const errors = errorDiv.children;
                while (errors.length > 10) {
                    errorDiv.removeChild(errors[errors.length - 1]);
                }
            }

            addParticleAt(x, y) {
                this.particles.push({
                    x: x,
                    y: y,
                    vx: (Math.random() - 0.5) * 6,
                    vy: (Math.random() - 0.5) * 6,
                    life: 1.0,
                    decay: 0.02,
                    color: `hsl(${Math.random() * 360}, 70%, 60%)`
                });
            }

            logToPerformanceLog(message) {
                const logDiv = document.getElementById('performance-log');
                const timestamp = new Date().toLocaleTimeString();
                
                const logHtml = `
                    <div style="margin: 3px 0; padding: 5px; background: rgba(243, 156, 18, 0.1); border-radius: 4px;">
                        <strong>${message}</strong>
                        <small style="float: right;">${timestamp}</small>
                    </div>
                `;
                
                logDiv.innerHTML = logHtml + logDiv.innerHTML;
                logDiv.style.display = 'block';
                
                // Keep only last 15 entries
                const entries = logDiv.children;
                while (entries.length > 15) {
                    logDiv.removeChild(entries[entries.length - 1]);
                }
            }
        }

        // Initialize application
        let app;

        document.addEventListener('DOMContentLoaded', function() {
            app = new VanillaJSApp();
        });

        // Global functions for HTML event handlers
        function setLayout(layout) {
            app.setLayout(layout);
            
            // Update active button
            document.querySelectorAll('.layout-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        function performOperation(operation) {
            app.performOperation(operation);
        }

        // API Testing Functions
        async function parallelFetch() {
            console.log('🔄 Starting parallel fetch requests...');
            const progress = document.getElementById('api-progress');
            const results = document.getElementById('api-results');
            
            progress.style.width = '20%';
            
            try {
                const promises = [
                    fetch('https://jsonplaceholder.typicode.com/posts/1'),
                    fetch('https://jsonplaceholder.typicode.com/users/1'),
                    fetch('https://jsonplaceholder.typicode.com/albums/1')
                ];
                
                progress.style.width = '60%';
                const responses = await Promise.all(promises);
                progress.style.width = '80%';
                
                const data = await Promise.all(responses.map(r => r.json()));
                progress.style.width = '100%';
                
                results.innerHTML = `
                    <strong>✅ Parallel requests completed:</strong><br>
                    Post: ${data[0].title}<br>
                    User: ${data[1].name}<br>
                    Album: ${data[2].title}
                `;
                
                console.log('✅ Parallel fetch completed', data);
            } catch (error) {
                console.error('❌ Parallel fetch failed:', error);
                results.innerHTML = `<strong>❌ Error:</strong> ${error.message}`;
            }
            
            setTimeout(() => progress.style.width = '0%', 2000);
        }

        async function sequentialFetch() {
            console.log('⏭️ Starting sequential fetch requests...');
            const progress = document.getElementById('api-progress');
            const results = document.getElementById('api-results');
            
            try {
                progress.style.width = '25%';
                const post = await fetch('https://jsonplaceholder.typicode.com/posts/1').then(r => r.json());
                
                progress.style.width = '50%';
                const user = await fetch('https://jsonplaceholder.typicode.com/users/1').then(r => r.json());
                
                progress.style.width = '75%';
                const album = await fetch('https://jsonplaceholder.typicode.com/albums/1').then(r => r.json());
                
                progress.style.width = '100%';
                
                results.innerHTML = `
                    <strong>✅ Sequential requests completed:</strong><br>
                    1. Post: ${post.title}<br>
                    2. User: ${user.name}<br>
                    3. Album: ${album.title}
                `;
                
                console.log('✅ Sequential fetch completed', { post, user, album });
            } catch (error) {
                console.error('❌ Sequential fetch failed:', error);
                results.innerHTML = `<strong>❌ Error:</strong> ${error.message}`;
            }
            
            setTimeout(() => progress.style.width = '0%', 2000);
        }

        async function raceCondition() {
            console.log('🏃‍♂️ Starting race condition test...');
            const results = document.getElementById('api-results');
            
            const slowPromise = new Promise(resolve => 
                setTimeout(() => resolve('Slow response'), 3000)
            );
            const fastPromise = new Promise(resolve => 
                setTimeout(() => resolve('Fast response'), 1000)
            );
            const fasterPromise = fetch('https://jsonplaceholder.typicode.com/posts/1')
                .then(r => r.json())
                .then(data => `API response: ${data.title}`);
            
            try {
                const winner = await Promise.race([slowPromise, fastPromise, fasterPromise]);
                results.innerHTML = `<strong>🏆 Race winner:</strong> ${winner}`;
                console.log('🏆 Race condition winner:', winner);
            } catch (error) {
                console.error('❌ Race condition failed:', error);
                results.innerHTML = `<strong>❌ Error:</strong> ${error.message}`;
            }
        }

        async function retryWithBackoff() {
            console.log('🔁 Testing retry logic with exponential backoff...');
            const results = document.getElementById('api-results');
            
            async function fetchWithRetry(url, maxRetries = 3) {
                for (let attempt = 1; attempt <= maxRetries; attempt++) {
                    try {
                        console.log(`🔄 Attempt ${attempt}/${maxRetries}`);
                        const response = await fetch(url);
                        
                        if (!response.ok && attempt < maxRetries) {
                            throw new Error(`HTTP ${response.status}`);
                        }
                        
                        return await response.json();
                    } catch (error) {
                        if (attempt === maxRetries) throw error;
                        
                        const delay = Math.pow(2, attempt) * 1000; // Exponential backoff
                        console.log(`⏳ Retrying in ${delay}ms...`);
                        await new Promise(resolve => setTimeout(resolve, delay));
                    }
                }
            }
            
            try {
                const data = await fetchWithRetry('https://jsonplaceholder.typicode.com/posts/1');
                results.innerHTML = `<strong>✅ Retry successful:</strong> ${data.title}`;
                console.log('✅ Retry with backoff succeeded', data);
            } catch (error) {
                console.error('❌ Retry with backoff failed:', error);
                results.innerHTML = `<strong>❌ All retries failed:</strong> ${error.message}`;
            }
        }

        async function simulateTimeouts() {
            console.log('⏱️ Testing timeout scenarios...');
            const results = document.getElementById('api-results');
            
            function fetchWithTimeout(url, timeout = 5000) {
                return Promise.race([
                    fetch(url),
                    new Promise((_, reject) => 
                        setTimeout(() => reject(new Error('Request timeout')), timeout)
                    )
                ]);
            }
            
            try {
                const response = await fetchWithTimeout('https://jsonplaceholder.typicode.com/posts/1', 2000);
                const data = await response.json();
                results.innerHTML = `<strong>✅ Request completed within timeout:</strong> ${data.title}`;
                console.log('✅ Timeout test passed', data);
            } catch (error) {
                console.error('⏱️ Request timed out:', error);
                results.innerHTML = `<strong>⏱️ Timeout:</strong> ${error.message}`;
            }
        }

        // Canvas Functions
        function startParticleSystem() {
            console.log('✨ Starting particle system...');
            app.particles = [];
            
            for (let i = 0; i < 50; i++) {
                app.particles.push({
                    x: Math.random() * 800,
                    y: Math.random() * 300,
                    vx: (Math.random() - 0.5) * 4,
                    vy: (Math.random() - 0.5) * 4,
                    life: 1.0,
                    decay: Math.random() * 0.02 + 0.005,
                    color: `hsl(${Math.random() * 360}, 70%, 60%)`
                });
            }
            
            animateParticles();
        }

        function animateParticles() {
            const canvas = document.getElementById('demo-canvas');
            const ctx = canvas.getContext('2d');
            const startTime = performance.now();
            
            ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            app.particles = app.particles.filter(particle => {
                particle.x += particle.vx;
                particle.y += particle.vy;
                particle.life -= particle.decay;
                
                if (particle.x < 0 || particle.x > canvas.width) particle.vx *= -1;
                if (particle.y < 0 || particle.y > canvas.height) particle.vy *= -1;
                
                ctx.globalAlpha = particle.life;
                ctx.fillStyle = particle.color;
                ctx.beginPath();
                ctx.arc(particle.x, particle.y, particle.life * 5, 0, Math.PI * 2);
                ctx.fill();
                
                return particle.life > 0;
            });
            
            ctx.globalAlpha = 1;
            document.getElementById('particles-count').textContent = app.particles.length;
            
            const renderTime = (performance.now() - startTime).toFixed(2);
            document.getElementById('render-time').textContent = renderTime;
            
            if (app.particles.length > 0) {
                app.animationId = requestAnimationFrame(animateParticles);
            }
        }

        function drawFractal() {
            console.log('🌀 Drawing fractal pattern...');
            const canvas = document.getElementById('demo-canvas');
            const ctx = canvas.getContext('2d');
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            function drawTree(x, y, angle, length, depth) {
                if (depth === 0) return;
                
                const endX = x + Math.cos(angle) * length;
                const endY = y + Math.sin(angle) * length;
                
                ctx.strokeStyle = `hsl(${depth * 30}, 70%, 60%)`;
                ctx.lineWidth = depth;
                ctx.beginPath();
                ctx.moveTo(x, y);
                ctx.lineTo(endX, endY);
                ctx.stroke();
                
                drawTree(endX, endY, angle - 0.5, length * 0.7, depth - 1);
                drawTree(endX, endY, angle + 0.5, length * 0.7, depth - 1);
            }
            
            drawTree(canvas.width / 2, canvas.height, -Math.PI / 2, 80, 8);
        }

        function animatedGraph() {
            console.log('📊 Creating animated graph...');
            const canvas = document.getElementById('demo-canvas');
            const ctx = canvas.getContext('2d');
            let frame = 0;
            
            function drawGraph() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const data = [];
                for (let i = 0; i < 50; i++) {
                    data.push(Math.sin((i + frame) * 0.1) * 50 + Math.cos((i + frame) * 0.05) * 30);
                }
                
                ctx.strokeStyle = '#f39c12';
                ctx.lineWidth = 3;
                ctx.beginPath();
                
                for (let i = 0; i < data.length; i++) {
                    const x = (i / data.length) * canvas.width;
                    const y = canvas.height / 2 + data[i];
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                
                ctx.stroke();
                frame++;
                
                if (frame < 300) {
                    requestAnimationFrame(drawGraph);
                }
            }
            
            drawGraph();
        }

        function clearCanvas() {
            const canvas = document.getElementById('demo-canvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            if (app.animationId) {
                cancelAnimationFrame(app.animationId);
                app.animationId = null;
            }
            
            app.particles = [];
            document.getElementById('particles-count').textContent = '0';
            console.log('🧹 Canvas cleared');
        }

        // Performance Testing Functions
        function memoryStressTest() {
            console.log('🧠 Starting memory stress test...');
            const arrays = [];
            
            for (let i = 0; i < 1000; i++) {
                arrays.push(new Array(1000).fill(Math.random()));
            }
            
            const start = performance.now();
            
            setTimeout(() => {
                arrays.length = 0;
                const end = performance.now();
                const duration = Math.round(end - start);
                
                document.getElementById('execution-time').textContent = duration;
                app.logToPerformanceLog(`Memory test completed in ${duration}ms`);
                console.log(`🧠 Memory stress test completed in ${duration}ms`);
            }, 1000);
        }

        function cpuIntensiveTask() {
            console.log('⚙️ Starting CPU intensive task...');
            const start = performance.now();
            
            let result = 0;
            for (let i = 0; i < 10000000; i++) {
                result += Math.sqrt(i) * Math.sin(i) * Math.cos(i);
            }
            
            const end = performance.now();
            const duration = Math.round(end - start);
            
            document.getElementById('execution-time').textContent = duration;
            document.getElementById('performance-score').textContent = Math.round(10000 / duration);
            
            app.logToPerformanceLog(`CPU intensive task: ${duration}ms, result: ${result.toFixed(2)}`);
            console.log(`⚙️ CPU intensive task completed in ${duration}ms`);
        }

        function memoryLeakTest() {
            console.log('🕳️ Simulating memory leak...');
            
            const leakyObjects = [];
            
            function createLeakyObject() {
                const obj = {
                    data: new Array(10000).fill(Math.random()),
                    timestamp: new Date(),
                    circular: null
                };
                obj.circular = obj; // Create circular reference
                return obj;
            }
            
            for (let i = 0; i < 100; i++) {
                leakyObjects.push(createLeakyObject());
            }
            
            app.logToPerformanceLog(`Created ${leakyObjects.length} potentially leaky objects`);
            console.log('🕳️ Memory leak simulation created');
        }

        function garbageCollectTest() {
            console.log('🗑️ Testing garbage collection...');
            
            if (window.gc) {
                window.gc();
                app.logToPerformanceLog('Manual garbage collection triggered');
            } else {
                app.logToPerformanceLog('Manual GC not available - creating objects for natural GC');
                
                for (let i = 0; i < 100000; i++) {
                    const temp = { data: Math.random() };
                }
            }
            
            console.log('🗑️ Garbage collection test completed');
        }

        function infiniteLoopTest() {
            console.log('♾️ Testing controlled infinite loop...');
            
            let iterations = 0;
            const maxIterations = 1000000;
            const start = performance.now();
            
            function controlledLoop() {
                for (let i = 0; i < 10000 && iterations < maxIterations; i++) {
                    iterations++;
                    Math.random(); // Some work
                }
                
                if (iterations < maxIterations) {
                    setTimeout(controlledLoop, 0); // Yield control
                } else {
                    const end = performance.now();
                    const duration = Math.round(end - start);
                    document.getElementById('execution-time').textContent = duration;
                    app.logToPerformanceLog(`Controlled loop: ${iterations} iterations in ${duration}ms`);
                    console.log(`♾️ Controlled loop completed: ${iterations} iterations`);
                }
            }
            
            controlledLoop();
        }

        // Error Testing Functions
        function throwSyntaxError() {
            try {
                eval('function malformed( { syntax error');
            } catch (error) {
                app.logError(`Syntax Error: ${error.message}`, error.stack);
                console.error('💥 Syntax error thrown:', error);
            }
        }

        function throwTypeError() {
            try {
                const obj = null;
                obj.someMethod();
            } catch (error) {
                app.logError(`Type Error: ${error.message}`, error.stack);
                console.error('🔤 Type error thrown:', error);
            }
        }

        function throwReferenceError() {
            try {
                console.log(undefinedVariable);
            } catch (error) {
                app.logError(`Reference Error: ${error.message}`, error.stack);
                console.error('🔗 Reference error thrown:', error);
            }
        }

        function promiseRejectionError() {
            Promise.reject(new Error('Unhandled promise rejection test'))
                .catch(error => {
                    app.logError(`Promise Rejection: ${error.message}`, error.stack);
                    console.error('🚫 Promise rejection:', error);
                });
        }

        function customErrorTest() {
            class CustomError extends Error {
                constructor(message) {
                    super(message);
                    this.name = 'CustomVanillaJSError';
                    this.timestamp = new Date().toISOString();
                }
            }
            
            try {
                throw new CustomError('This is a custom error for testing');
            } catch (error) {
                app.logError(`Custom Error: ${error.message}`, error.stack);
                console.error('🎯 Custom error thrown:', error);
            }
        }

        function logComplexObjects() {
            const complexData = {
                user: {
                    id: 12345,
                    profile: {
                        name: 'Vanilla JS Developer',
                        skills: ['JavaScript', 'HTML5', 'CSS3', 'WebAPIs'],
                        experience: {
                            years: 5,
                            projects: [
                                { name: 'DevInspector Demo', tech: 'Vanilla JS' },
                                { name: 'Canvas Game', tech: 'HTML5 Canvas' }
                            ]
                        }
                    }
                },
                session: {
                    startTime: new Date(),
                    actions: ['login', 'navigate', 'interact'],
                    metrics: new Map([
                        ['pageViews', 15],
                        ['clickEvents', 42],
                        ['errors', 0]
                    ])
                },
                performance: {
                    loadTime: performance.now(),
                    memory: performance.memory ? {
                        used: performance.memory.usedJSHeapSize,
                        total: performance.memory.totalJSHeapSize,
                        limit: performance.memory.jsHeapSizeLimit
                    } : null
                }
            };
            
            console.group('📦 Complex Object Logging Test');
            console.log('🧑‍💻 User Profile:', complexData.user);
            console.log('📊 Session Data:', complexData.session);
            console.log('⚡ Performance Metrics:', complexData.performance);
            console.table(complexData.user.profile.skills);
            console.groupEnd();
        }

        function performanceMarks() {
            console.log('⏱️ Testing performance marks and measures...');
            
            performance.mark('operation-start');
            
            // Simulate some work
            for (let i = 0; i < 100000; i++) {
                Math.sqrt(i);
            }
            
            performance.mark('operation-middle');
            
            // More work
            for (let i = 0; i < 50000; i++) {
                Math.sin(i);
            }
            
            performance.mark('operation-end');
            
            performance.measure('first-half', 'operation-start', 'operation-middle');
            performance.measure('second-half', 'operation-middle', 'operation-end');
            performance.measure('total-operation', 'operation-start', 'operation-end');
            
            const measures = performance.getEntriesByType('measure');
            console.group('⏱️ Performance Measurements');
            measures.forEach(measure => {
                console.log(`${measure.name}: ${measure.duration.toFixed(2)}ms`);
            });
            console.groupEnd();
            
            app.logToPerformanceLog('Performance marks and measures logged');
        }

        function stackTraceDemo() {
            function level1() {
                level2();
            }
            
            function level2() {
                level3();
            }
            
            function level3() {
                const error = new Error('Stack trace demonstration');
                console.group('📚 Stack Trace Demo');
                console.log('Stack trace:', error.stack);
                console.trace('Custom trace from level3');
                console.groupEnd();
                
                app.logError('Stack Trace Demo', error.stack);
            }
            
            level1();
        }

        // Cleanup when page unloads
        window.addEventListener('beforeunload', function() {
            if (app && app.inspector) {
                app.inspector.destroy();
                console.log('🧹 Vanilla JS application destroyed');
            }
        });

        // Log successful initialization
        console.group('🟨 Vanilla JavaScript DevInspector Demo');
        console.log('🎯 Pure JavaScript implementation loaded');
        console.log('📊 All modern JavaScript features available');
        console.log('🔍 DevInspector ready for comprehensive testing');
        console.groupEnd();
    </script>
</body>
</html>